{* 
/***************************************************************************
                              crew_search.tpl
*                            --------------------------
*   begin                : Sunday, August 28, 2005
*   copyright            : (C) 2005 Atari Legend
*   email                : admin@atarilegend.com
*
*   Id: crew_search.tpl,v 0.10 2005/10/29 Silver
*
***************************************************************************/

************************************************************************************************
The main game page
************************************************************************************************
*}
{extends file='head.html'}
{block name=head}
<script type="text/javascript">
function crewinsert()
{
    JSnewcrew=document.forms["insertcrew"].newcrew.value;
	
	if (JSnewcrew=='')
	{
		alert('Please fill in a crew name');
	}
	else
	{
    	// CONFIRM REQUIRES ONE ARGUMENT
    	var message = "Are you sure you want to insert this crew into the database?";
    	// CONFIRM IS BOOLEAN. THAT MEANS THAT
    	// IT RETURNS TRUE IF 'OK' IS CLICKED
    	// OTHERWISE IT RETURN FALSE
    	var return_value = confirm(message);
		
    	if (return_value !="0")
    	{
    		url="db_crew.php?new_crew="+JSnewcrew+"&action=insert_crew";
			location.href=url;
    	} 
	}
}
</script>

<script language="JavaScript">
function browseSubCrew(str2) {
    if (str2 == "") {
        document.getElementById("sub_crew").innerHTML = "";
        return;
    } else { 
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
            {
                document.getElementById("sub_crew").innerHTML = xmlhttp.responseText;
            } 
        }
        xmlhttp.open("GET","../crew/ajax_crew_search.php?crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}&action=crew_gen_browse&query="+str2,true);
        xmlhttp.send();
    }
}
</script>

<script language="JavaScript">
function browseCrew(str) {
    if (str == "") {
        document.getElementById("crew_list").innerHTML = "";
        return;
    } else { 
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById("crew_list").innerHTML = xmlhttp.responseText;
            }
        }
        xmlhttp.open("GET","../crew/ajax_crew_search.php?crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}&action=crew_browse&query="+str,true);
        xmlhttp.send();
    }
}
</script>

<script language="JavaScript">
function browseInd(str) {
    if (str == "") {
        document.getElementById("ind_member").innerHTML = "";
        return;
    } else { 
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById("ind_member").innerHTML = xmlhttp.responseText;
            }
        }
        xmlhttp.open("GET","../crew/ajax_crew_search.php?crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}&action=ind_gen_browse&query="+str,true);
        xmlhttp.send();
    }
}
</script>

<script language="JavaScript">
function searchInd(str) {
    if (str == "") {
        str = "empty";
			xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById("ind_member").innerHTML = xmlhttp.responseText;
            }
        }   

    } else { 
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById("ind_member").innerHTML = xmlhttp.responseText;
            }
        }
        xmlhttp.open("GET","../crew/ajax_crew_search.php?crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}&action=ind_gen_search&query="+str,true);
        xmlhttp.send();
    }
}
</script>
{/block}
{block name=body}
<div class="MAINHEADERBAR">
<div class="MAINHEADING">&nbsp;Crew editor</div>
</div>

<table width="100%" cellspacing="2" cellpadding="5" align="center" class="CELLCOLOR">
<tr>
	<td align="center" width="50%">
	
	
	
		<form action="../crew/crew_search.php" method="post" name="crew_search" id="crew_search">
		<fieldset class="interview_set">
		<legend class="links_legend">Search crews</legend>
		
				<b>By name :</b>
		
				<select name="crewbrowse" onchange="browseCrew(this.value)">
					<option value=""{if $tracking.crewbrowse eq ''} SELECTED{/if}>-</option>
					<option value="num"{if $tracking.crewbrowse eq 'num'} SELECTED{/if}>0-9</option>
					<option value="a"{if $tracking.crewbrowse eq 'a'} SELECTED{/if}>A</option>
					<option value="b"{if $tracking.crewbrowse eq 'b'} SELECTED{/if}>B</option>
					<option value="c"{if $tracking.crewbrowse eq 'c'} SELECTED{/if}>C</option>
					<option value="d"{if $tracking.crewbrowse eq 'd'} SELECTED{/if}>D</option>
					<option value="e"{if $tracking.crewbrowse eq 'e'} SELECTED{/if}>E</option>
					<option value="f"{if $tracking.crewbrowse eq 'f'} SELECTED{/if}>F</option>
					<option value="g"{if $tracking.crewbrowse eq 'g'} SELECTED{/if}>G</option>
					<option value="h"{if $tracking.crewbrowse eq 'h'} SELECTED{/if}>H</option>
					<option value="i"{if $tracking.crewbrowse eq 'i'} SELECTED{/if}>I</option>
					<option value="j"{if $tracking.crewbrowse eq 'j'} SELECTED{/if}>J</option>
					<option value="k"{if $tracking.crewbrowse eq 'k'} SELECTED{/if}>K</option>
					<option value="l"{if $tracking.crewbrowse eq 'l'} SELECTED{/if}>L</option>
					<option value="m"{if $tracking.crewbrowse eq 'm'} SELECTED{/if}>M</option>
					<option value="n"{if $tracking.crewbrowse eq 'n'} SELECTED{/if}>N</option>
					<option value="o"{if $tracking.crewbrowse eq 'o'} SELECTED{/if}>O</option>
					<option value="p"{if $tracking.crewbrowse eq 'p'} SELECTED{/if}>P</option>
					<option value="q"{if $tracking.crewbrowse eq 'q'} SELECTED{/if}>Q</option>
					<option value="r"{if $tracking.crewbrowse eq 'r'} SELECTED{/if}>R</option>
					<option value="s"{if $tracking.crewbrowse eq 's'} SELECTED{/if}>S</option>
					<option value="t"{if $tracking.crewbrowse eq 't'} SELECTED{/if}>T</option>
					<option value="u"{if $tracking.crewbrowse eq 'u'} SELECTED{/if}>U</option>
					<option value="v"{if $tracking.crewbrowse eq 'v'} SELECTED{/if}>V</option>
					<option value="w"{if $tracking.crewbrowse eq 'w'} SELECTED{/if}>W</option>
					<option value="x"{if $tracking.crewbrowse eq 'x'} SELECTED{/if}>X</option>
					<option value="y"{if $tracking.crewbrowse eq 'y'} SELECTED{/if}>Y</option>
					<option value="z"{if $tracking.crewbrowse eq 'z'} SELECTED{/if}>Z</option>
				</select>
				<input type="text" name="crewsearch" value="{if (isset($new_crew) and $new_crew <> '')}{$new_crew}{/if}" style="width:70px;">
		
			<input type="submit" value="Search">
		
		</fieldset>
		<input type="hidden" name="action" id="action" value="search">
		</form>	
	</td>
	
	
	
	
	
	<td align="center" width="50%">
	{if (isset($new_crew) and $new_crew <> '')}
		<span class="MAINNAV" style="text-align:center;">
		{$new_crew} added to the database!<br/>
		</span>
	{/if}
		<form method="post" name="insertcrew">
		<fieldset class="interview_set">
		<legend class="links_legend">Add Crew</legend>
			<input type="text" name="newcrew">
			<input type="submit" value="Insert" onClick="crewinsert(); return false;">	
		</fieldset>
		</form>
		<br/>
	</td>
</tr>
<tr>
	<td colspan="2">
	
	<table width="100%">
	<tr>
	<td width="20%" style="vertical-align:top;">
	
<div class="NEWNAVCELL">

	<li class="NEWHEADERBAR">Search Results</li>

<div id="crew_list">

	{* SEARCH RESULTS - UNDERLINE IF SELECTED *}
	{foreach from=$crew item=line}
			
			{if (isset($crew_select.crew_id) and $crew_select.crew_id eq $line.crew_id)}
			<li class="leftnav_list" style="background-color:#b2b2b2;">
			<a href="../crew/crew_editor.php?crew_select={if isset($line.crew_id)}{$line.crew_id}{/if}&crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}" class="LEFTNAV">
			{$line.crew_name}
			</a>
			</li>
			{else}
			<li class="leftnav_list">
			<a href="../crew/crew_editor.php?crew_select={if isset($line.crew_id)}{$line.crew_id}{/if}&crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}" class="LEFTNAV">
			{$line.crew_name}
			</a>
			</li>
			{/if}
	{/foreach}	
	
</div>	

</div>

	</td>
	<td width="80%">
	{* Start crew editing table	*}
	<table width="100%" cellspacing="2" cellpadding="0" border="0" style="margin-left: auto; margin-right: auto;">
		<tr>
			<td style="width:25%;" align="center">
				<form action="../crew/crew_search.php" method="post" name="main_edit" id="main_edit">
		
					<input type="submit" value="Main edit">
					<input type="hidden" name="action" id="action1" value="main">
					<input type="hidden" name="crew_select" id="crew_select1" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
					<input type="hidden" name="crewsearch" id="crewsearch1" value="{$tracking.crewsearch}">
					<input type="hidden" name="crewbrowse" id="crewbrowse1" value="{$tracking.crewbrowse}">
				</form>	
			</td>
			<td style="width:25%;" align="center">
				<form action="../crew/crew_search.php" method="get" name="Genealogy" id="Genealogy">
		
					<input type="submit" value="Genealogy">
					<input type="hidden" name="action" id="action2" value="genealogy">
					<input type="hidden" name="crew_select" id="crew_select2" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
					<input type="hidden" name="crewsearch" id="crewsearch2" value="{$tracking.crewsearch}">
					<input type="hidden" name="crewbrowse" id="crewbrowse2" value="{$tracking.crewbrowse}">
				</form>
			</td>
			<td style="width:25%;" align="center">
				<form action="" method="post" name="Statistics" id="Statistics">
		
					<input type="submit" value="Statistics">
					<input type="hidden" name="action" id="action3" value="statistics">
					<input type="hidden" name="crew_select" id="crew_select3" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
					<input type="hidden" name="crewsearch" id="crewsearch3" value="{$tracking.crewsearch}">
					<input type="hidden" name="crewbrowse" id="crewbrowse3" value="{$tracking.crewbrowse}">
				</form>
			</td>
			<td style="width:25%;" align="center">
				<form action="" method="post" name="Comments_Submissions" id="Comments_Submissions">
		
					<input type="submit" value="Comments/Submissions">
					<input type="hidden" name="action" id="action4" value="comments">
					<input type="hidden" name="crew_select" id="crew_select4" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
					<input type="hidden" name="crewsearch" id="crewsearch4" value="{$tracking.crewsearch}">
					<input type="hidden" name="crewbrowse" id="crewbrowse4" value="{$tracking.crewbrowse}">
				</form>
			</td>
		</tr>
		<tr>
			<td colspan="4">
			{* START THE CREW GENEALOGY EDIT *}
			<table width="100%" cellspacing="2" cellpadding="15" align="center" border="0">
<tr>
	<td colspan="2">
	<fieldset class="category_set_noGrave" style="margin-left: 5%;margin-right: 5%; width:90%;">
		This is the scene genealogy page where we can add members to crews. We can add both indiviual members and subcrews.
	</fieldset> 
	</td>
</tr>
<tr>
	<td>
	
		<table width="100%" cellspacing="0" cellpadding="0">
		<tr>
			<td width="50%">
				
			<div style="float:left;padding-left:55px;">
			<form action="../crew/db_crew.php" method="post" name="crew_gene2" id="crew_gene2">
				<select id="crewbrowse2" onchange="browseSubCrew(this.value)">
					<option value="num" selected>0-9</option>
					<option value="a">A</option>
					<option value="b">B</option>
					<option value="c">C</option>
					<option value="d">D</option>
					<option value="e">E</option>
					<option value="f">F</option>
					<option value="g">G</option>
					<option value="h">H</option>
					<option value="i">I</option>
					<option value="j">J</option>
					<option value="k">K</option>
					<option value="l">L</option>
					<option value="m">M</option>
					<option value="n">N</option>
					<option value="o">O</option>
					<option value="p">P</option>
					<option value="q">Q</option>
					<option value="r">R</option>
					<option value="s">S</option>
					<option value="t">T</option>
					<option value="u">U</option>
					<option value="v">V</option>
					<option value="w">W</option>
					<option value="x">X</option>
					<option value="y">Y</option>
					<option value="z">Z</option>
				</select>
			</form>	
			</div>	
			<div style="float:right;padding-right:105px;">	
			<form action="../crew/db_crew.php" method="post" name="crew_gene" id="crew_gene">
			
			
			
			<div id="sub_crew">
			<select name="sub_crew[]" id="subCrewList" size="10" multiple style="width:200px;">
				
				
					
				<option value="" selected>-</option>
			
					{foreach from=$crew_gene item=line}
						{if $line.crew_id <> $crew_select.crew_id}
							<option value="{$line.crew_id}">{$line.crew_name}</option>
						{/if}
					{/foreach}	
				
			</select>
			</div>
			<br/>
			<input type="hidden" name="action" value="parent_crew">
			<input type="hidden" name="parent_id" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
			<input type="hidden" name="crew_select" id="crew_select8" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
			<input type="hidden" name="crewsearch" id="crewsearch8" value="{$tracking.crewsearch}">
			<input type="hidden" name="crewbrowse" id="crewbrowse8" value="{$tracking.crewbrowse}">
			<input type="submit" value="Add Subcrew">
			
			</form>
			</div>
			</td>
			<td width="50%">
			
			
			<table width="100%" cellspacing="0" cellpadding="0">
				<tr>
					<td width="25%" style="vertical-align:top;">
					
					 <FORM action= method=post name=f1
      onsubmit="return false;">
      <SELECT class=saveHistory id=m1 name=m1 onchange="browseInd(this.value)">

						<option value="a">A</option>
						<option value="b">B</option>
						<option value="c">C</option>
						<option value="d">D</option>
						<option value="e">E</option>
						<option value="f">F</option>
						<option value="g">G</option>
						<option value="h">H</option>
						<option value="i">I</option>
						<option value="j">J</option>
						<option value="k">K</option>
						<option value="l">L</option>
						<option value="m">M</option>
						<option value="n">N</option>
						<option value="o">O</option>
						<option value="p">P</option>
						<option value="q">Q</option>
						<option value="r">R</option>
						<option value="s">S</option>
						<option value="t">T</option>
						<option value="u">U</option>
						<option value="v">V</option>
						<option value="w">W</option>
						<option value="x">X</option>
						<option value="y">Y</option>
						<option value="z">Z</option>

        				</SELECT>
						<br/><br/>
						Search<br/>
						<input type="text" onkeyup="searchInd(this.value)" style="width:100px;">

      				</FORM>
					
					</td>
					<td width="75%" style="vertical-align:top;" align="left">
					
					      <FORM action="../crew/db_crew.php" method="post">
   		<div id="ind_member">   
      <SELECT id="ind_id" name="ind_id" size="10" style="width:200px;">

        {foreach from=$ind_gene item=line}
				<option value="{$line.ind_id}">{$line.ind_name}</option>
		{/foreach}	



        </SELECT>
  	</div>	      
        <br/>
			<input type="hidden" name="action" value="add_member">
			<input type="hidden" name="parent_id" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
			<input type="hidden" name="crew_select" id="crew_select8" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
			<input type="hidden" name="crewsearch" id="crewsearch8" value="{$tracking.crewsearch}">
			<input type="hidden" name="crewbrowse" id="crewbrowse8" value="{$tracking.crewbrowse}">
        <INPUT type="submit" value="Add Crewmember">
</FORM>
					
					</td>
				</tr>
			</table>

			</td>
		</tr>
		<tr>{* MEMBERS OF CREW *}
			<td width="100%" colspan="2">
			<br/>
			<fieldset>
			<legend class="links_legend">Members</legend>
			
			<table cellspacing="2" cellpadding="2" border="0" width="100%">
				<tr>
					<td width="50%" valign="top">
					
					<table cellspacing="0" cellpadding="2" border="0" width="100%" style="border: solid 1px #b2b2b2; background-color:#E9E9E9;">
					<tr>
						<td valign="top" width="25%"><b>SubCrews</b></td>
					</tr>
					</table>	
					<table cellspacing="0" cellpadding="2" border="0" width="100%" style="border: solid 1px #b2b2b2; background-color:#E9E9E9;">
					{if isset($subcrew)}					
					{foreach from=$subcrew item=line}
					<tr bgcolor="{cycle name="tr" values="#EFEFEF,#E9E9E9"}">
						<td width="75%" valign="top">
							{$line.crew_name}</td>
						<td width="25%" valign="top">
						<a href="../crew/db_crew.php?action=delete_subcrew&crew_select={if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}&crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}&sub_crew_id={$line.sub_crew_id}" class="MAINNAV">Delete</a>
						</td>
					</tr>
					{/foreach}
					{/if}
					</table>
					
					
					</td>
					<td width="50%" valign="top" align="right">
					
	
							<div class="Table" style="align:left;margin-right: auto; width:100%;">
								<div class="Heading">
									<div class="Cell" style="width:30%;font-size:11px;">
										"Sceners"
									</div>
									<div class="Cell" style="width:30%;font-size:11px;">
										Used nick
									</div>				
									<div class="Cell" style="width:40%;">
										
									</div>
								</div>
							</div>
					
							<div class="Table" style="align:left;margin-right: auto; width:100%;">
								
								{if isset($crew_individuals)}
								{foreach name=outer item=individual from=$crew_individuals}	
								<div class="Row" style="background-color:{cycle name="tr" values="#EFEFEF,#E9E9E9"};">
									<div class="Cell" style="width:30%;font-size:11px;">
										{$individual.ind_name}
									</div>
									<form action="../crew/db_crew.php" method="post" name="nick_edit{$individual.ind_id}" id="nick_edit{$individual.ind_id}">
									<div class="Cell" style="width:30%;font-size:11px;">
									<select name="individual_nicks_id" id="individual_nicks_id" size="1">
						<option value="-" {if $individual.individual_nicks_id <> ''} {else}SELECTED{/if}>None</option>

						{if isset($nick_names)}
						{foreach name=inner item=line from=$nick_names}
						{if (isset($individual.ind_id) and $individual.ind_id eq $line.ind_id)}
						<option value="{$line.individual_nicks_id}" {if $individual.individual_nicks_id eq $line.individual_nicks_id}SELECTED{/if}>{$line.nick}</option>
						{/if}
						{/foreach}
						{/if}

						</select>
									</div>				
									<div class="Cell" style="width:30%;overflow: hidden;margin: 0 auto;">
																<input type="hidden" name="action" value="update_nick">
						<input type="hidden" name="crew_individual_id" value="{$individual.crew_individual_id}">
						<input type="hidden" name="parent_id" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
						<input type="hidden" name="crew_select" id="crew_select8" value="{if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}">
						<input type="hidden" name="crewsearch" id="crewsearch8" value="{$tracking.crewsearch}">
						<input type="hidden" name="crewbrowse" id="crewbrowse8" value="{$tracking.crewbrowse}">		
						<input type="submit" name="inserter" value="Update" style="margin: 0 auto;">
									
									</form>
									</div>
									<div class="Cell" style="width:10%;">
										<a href="../crew/db_crew.php?action=delete_crew_member&crew_select={if isset($crew_select.crew_id)}{$crew_select.crew_id}{/if}&crewsearch={$tracking.crewsearch}&crewbrowse={$tracking.crewbrowse}&crew_individual_id={$individual.crew_individual_id}" class="MAINNAV">Delete</a>
									</div>
								</div>
													{/foreach}
					{/if}
							</div>					
					
					
				
	
					</td>
				</tr>
			</table>
		
			</fieldset>
			</td>
		</tr>
	

		</table>
	</td>
</tr>
</table>
			{* END THE CREW GENEALOGY EDIT *}
			</td>
		</tr>
	</table>
	{* End crew editing table	*}
	</td>
	</tr>
	</table>
	</td>
</tr>
</table>
<div class="MAINHEADERBAR">
<div class="MAINHEADING">&nbsp;&nbsp;&nbsp;</div>
</div>

{if isset($message)}
	<div style="text-align: center;">
			<br/><br/>
			<span class="MAINAV">{$message}</span>
		</div>
{/if}
{/block}
