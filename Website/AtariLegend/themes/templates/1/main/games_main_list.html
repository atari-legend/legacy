{*
/***************************************************************************
                              games_main_list.html
*                            --------------------------
*   begin                : Sunday, June 25, 2017
*   copyright            : (C) 2017 Atari Legend
*   email                : admin@atarilegend.com
*
*   Id: games_main_list.html,v 0.10 2017/06/25 23:19 Gatekeeper
*
***************************************************************************/

************************************************************************************************
The main game page
************************************************************************************************
*}

{extends file='1/main/main.html'}



{block name=main_body}
    <script type="text/javascript" src="{$template_dir}includes/js/lightbox.min.js"></script>
    <link type="text/css" href="{$style_dir}css/lightbox.css" hreflang="en" rel="stylesheet">
    
    <div id="main" class="main_container_cpanel">
        <div class="content_box_cpanel" id="column_left_cpanel">
            <br>
            {block name=left_tile}
                 {include file='1/main/latest_comments_tile.html'}
            {/block}
        </div>
        <div class="content_box_cpanel" id="column_center_cpanel">
            <br>
            {if isset($export) and ($export == 'export')}
            <div class="standard_tile" id="games_main">
                <div class="help-tip">
                    <p> 
                       To filter on boxscan, screenshot, download or music, use '1' (=has) or '0' (=has not)
                    </p>
                </div>
                <h1>GAMES</h1>
                <div class="standard_tile_line"></div>
                <div class="standard_tile_text">
                    <h6>
                        This is the search result page. Click a game to go to the main page. Click a Publisher/Developer/Year to do a new search. This list has sort functions, filters and you can use the download button to export the contents.
                    </h6>
                </div>
                <div class="standard_tile_line"></div>
                <br> 
                <div class="games_tabulator_list">                
                    <button id="download-csv" class="export_button">Download CSV</button>
                    <button id="download-json" class="export_button">Download JSON</button>
                    <button id="download-xlsx" class="export_button">Download XLSX</button>
                    <br>
                    <br>
                    <div id="games-table"></div>
                    <br>
                    <div class="online_title">
                        <b>{if $nr_of_games == 1}1 game found {else} {$nr_of_games} games found{/if} in {$query_time} sec</b>
                    </div>
                </div>
                <script type="text/javascript" src="{$template_dir}includes/js/tabulator.min.js"></script> <!-- tabulator script -->
                <script type="text/javascript" src="{$template_dir}includes/js/xlsx.full.min.js"></script> <!-- export to xlsx script -->
                <script>
                //define some sample data
                var tabledata = {$data};
               
                {literal}
                
                //create Tabulator on DOM element with id "example-table"
                $("#games-table").tabulator({
                    responsiveLayout:true, // this option takes a boolean value (default = false)
                    fitColumns:true,
                    pagination:"local",
                    columns:[ //Define Table Columns
                        {title:"Name", field:"game_name", sorter:"string", align:"left", headerFilter:"input", minWidth:150, responsive:0},
                        {title:"Publisher", field:"publisher_name", sorter:"string", align:"left", headerFilter:"input", minWidth:150, cellClick:function(e, cell){window.location="../games/games_main_list.php?publisher=" + cell.getRow().getData().publisher_id + "&action=search&export=1"}},
                        {title:"Developer", field:"developer_name", sorter:"string", align:"left", headerFilter:"input", minWidth:150, cellClick:function(e, cell){window.location="../games/games_main_list.php?developer=" + cell.getRow().getData().developer_id + "&action=search&export=1"}},
                        {title:"Year", field:"year", sorter:"string", align:"left",headerFilter:"input", width:75, minWidth:50, cellClick:function(e, cell){window.location="../games/games_main_list.php?year=" + cell.getRow().getData().year + "&action=search&export=1"}},
                        {title:"Boxscan", field:"boxscan", sorter:"string", formatter:"tickCross",headerFilter:"input", width:100, minWidth:50},
                        {title:"Screenshot", field:"screenshot", sorter:"string", formatter:"tickCross",headerFilter:"input", width:120, minWidth:50},
                        {title:"Download", field:"download", sorter:"string", formatter:"tickCross",headerFilter:"input", width:110, minWidth:50},
                        {title:"Music", field:"music", sorter:"string", formatter:"tickCross",headerFilter:"input", width:75, minWidth:50},
                    ],
                });
                $("#games-table").tabulator("setPageSize", 25); // show 25 rows per page

                //trigger download of data.csv file
                $("#download-csv").click(function(){
                    $("#games-table").tabulator("download", "csv", "data.csv");
                });

                //trigger download of data.json file
                $("#download-json").click(function(){
                    $("#games-table").tabulator("download", "json", "data.json");
                });

                //trigger download of data.xlsx file
                $("#download-xlsx").click(function(){
                    $("#games-table").tabulator("download", "xlsx", "data.xlsx");
                });

                //load sample data into the table
                $("#games-table").tabulator("setData", tabledata);
                
                $(window).on('resize', function () {
                    $(".tabulator").tabulator("redraw");
                });

                {/literal}
                </script>	
            </div>
            {else}
                <div class="standard_tile" id="games_main">
                     <div class="help-tip">
                        <p> 
                            <i class="fa fa-camera" aria-hidden="true"></i> - Screenshot <br>
                            <i class="fa fa-music" aria-hidden="true"></i> - Music <br>
                            <i class="fa fa-cube" aria-hidden="true"></i> - Boxscan <br>
                            <i class="fa fa-file-o" aria-hidden="true"></i> - Download <br>
                            <i class="fa fa-newspaper-o" aria-hidden="true"></i> - Review <br> 
                        </p>
                    </div>
                    <h1>GAMES</h1>
                    <div class="standard_tile_line"></div>
                    <br>
                    <form action="../games/games_main_list.php" method="get" name="game_search">
                        <div class="games_main_row_site">
                            <div class="games_main_list_info" style="text-align:left;">Title</div>
                            <div class="games_main_text_short"><span class="games_main_list_info">:</span></div>
                            <div class="games_main_input_list_text">
                                <input type="text" name="gamesearch" value="" class="standard_tile_input_small_site" id="gamesearch" style="height:20px;">
                            </div>
                        </div>
                        <div class="games_main_row_site">
                            <div class="games_main_list_info" style="text-align:left;">By Publisher</div>
                            <div class="games_main_text_short"><span class="games_main_list_info">:</span></div>
                            <div class="games_main_input_site">
                                <select name="publisher" id="games_main_select_site" style="height:20px;">
                                    <option value="-" SELECTED>-</option>
                                    {foreach from=$company_publisher item=line}
                                        <option value="{$line.comp_id}">{$line.comp_name}</option>
                                    {/foreach}
                                </select>
                            </div>
                        </div>
                        <div class="games_main_row_site">
                            <div class="games_main_list_info" style="text-align:left;">By Developer</div>
                            <div class="games_main_text_short"><span class="games_main_list_info">:</span></div>
                            <div class="games_main_input_site">
                                <select name="developer" id="games_main_select_site" style="height:20px;">
                                    <option value="-" SELECTED>-</option>
                                    {foreach from=$company_developer item=line}
                                        <option value="{$line.comp_id}">{$line.comp_name}</option>
                                    {/foreach}
                                </select>
                            </div>
                        </div>
                        <div class="games_main_row_site">
                            <div class="games_main_list_info" style="text-align:left;">Release year</div>
                            <div class="games_main_text_short"><span class="games_main_list_info">:</span></div>
                            <div class="games_main_input_site">
                                <select name="year" id="games_main_select_site" style="height:20px;">
                                    <option value="-" SELECTED>-</option>
                                    {foreach from=$game_year item=line}
                                        <option value="{$line.game_year}">{$line.game_year}</option>
                                    {/foreach}
                                </select>
                            </div>
                        </div>
                        <div class="standard_table_center">
                            <br>
                            <input type="submit" value="SEARCH" class="quick_search_games_button" style="height:20px;margin-bottom:15px;">
                        </div>      
                        <input type="hidden" name="action" id="action" value="search">
                        <input type="hidden" name="mode" id="mode" value="{if isset($mode)}{$mode}{/if}">
                    </form>
                    <div class="standard_tile_line"></div>
                    <div id="games_list_4">
                        <table class="standard_table_list_comments_main">
                            {$tr = true} 
                            {foreach from=$game_search item=line name=game_search}
                                {if $tr} 
                                    <tr>
                                    {$tr = false}    
                                {/if}
                                    <td style="width:25%;">
                                        {if $line.screenshot_id != ''}
                                            <div class="games_main_list_title">
                                                <a href="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=410,null,null,null" data-lightbox="image-1" data-title="{$line.game_name}">
                                                    <br><img src="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=200,null,null,null" width="200" alt="Click to enlarge!" class="game_main_list_screenshot_img">
                                                </a>
                                            </div>
                                        {/if}
                                        <div class="games_main_list_title">
                                            <a href="games_detail.php?game_id={$line.game_id}" class="standard_table_left">
                                                <br>{$line.game_name}
                                            </a>
                                        </div>
                                        <div class="games_main_list_info">
                                            <a href="games_main_list.php?publisher={$line.publisher_id}&amp;action=search" class="standard_table_left">{$line.publisher_name}</a>{if (isset($line.year))}<a href="games_main_list.php?year={$line.year}&amp;action=search" class="standard_table_left">, {$line.year}</a>{/if}
                                        </div>  
                                        <div class="games_main_list_info" style="margin-bottom:10px;">
                                            {if $line.screenshot_id != ''}
                                                <i class="fa fa-camera" aria-hidden="true" title="More screenshots available"></i>
                                            {/if}
                                            {if isset($line.music)}
                                                <i class="fa fa-music" aria-hidden="true" title="Music available"></i>
                                            {/if}
                                            {if isset($line.boxscan)}
                                                <i class="fa fa-cube" aria-hidden="true" title="Boxscan available"></i>
                                            {/if}
                                            {if isset($line.download)}
                                                <i class="fa fa-file-o" aria-hidden="true" title="Download available"></i>
                                            {/if}
                                            {if isset($line.review)}
                                                <i class="fa fa-newspaper-o" aria-hidden="true" title="Review available"></i>
                                            {/if}                                        
                                            {if isset($line.screenshot_id) or isset($line.music) or isset($line.boxscan) or isset($line.download)}
                                            {else}
                                                <br>
                                            {/if}
                                        </div>
                                   </td>
                                 {if $smarty.foreach.game_search.iteration is div by 4}       
                                    </tr> 
                                    {$tr = true} 
                                 {/if} 
                            {/foreach}
                            <tr>
                                <td colspan="4"><div class="games_main_list_title"><br>{if $nr_of_games == 1}1 game found {else} {$nr_of_games} games found{/if} in {$query_time} sec<br><br></div></td>
                            </tr>
                        </table>
                    </div>                      
                    <div id="games_list_3">
                        <table class="standard_table_list_comments">
                            {$tr = true} 
                            {foreach from=$game_search item=line name=game_search}
                                {if $tr} 
                                    <tr>
                                    {$tr = false}    
                                {/if}
                                    <td style="width:25%;">
                                        {if $line.screenshot_id != ''}
                                            <div class="games_main_list_title">
                                                <a href="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=410,null,null,null" data-lightbox="image-1" data-title="{$line.game_name}">
                                                    <br><img src="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=200,null,null,null" width="200" alt="Click to enlarge!" class="game_main_list_screenshot_img">
                                                </a>
                                            </div>
                                        {/if}
                                        <div class="games_main_list_title">
                                            <a href="games_detail.php?game_id={$line.game_id}" class="standard_table_left">
                                                <br>{$line.game_name}
                                            </a>
                                        </div>
                                        <div class="games_main_list_info">
                                            <a href="games_main_list.php?publisher={$line.publisher_id}&amp;action=search" class="standard_table_left">{$line.publisher_name}</a>{if (isset($line.year))}<a href="games_main_list.php?year={$line.year}&amp;action=search" class="standard_table_left">, {$line.year}</a>{/if}
                                        </div>  
                                        <div class="games_main_list_info" style="margin-bottom:10px;">
                                            {if $line.screenshot_id != ''}
                                                <i class="fa fa-camera" aria-hidden="true" title="More screenshots available"></i>
                                            {/if}
                                            {if isset($line.music)}
                                                <i class="fa fa-music" aria-hidden="true" title="Music available"></i>
                                            {/if}
                                            {if isset($line.boxscan)}
                                                <i class="fa fa-cube" aria-hidden="true" title="Boxscan available"></i>
                                            {/if}
                                            {if isset($line.download)}
                                                <i class="fa fa-file-o" aria-hidden="true" title="Download available"></i>
                                            {/if}
                                            {if isset($line.screenshot_id) or isset($line.music) or isset($line.boxscan) or isset($line.download)}
                                            {else}
                                                <br>
                                            {/if}
                                        </div>
                                   </td>
                                 {if $smarty.foreach.game_search.iteration is div by 3}       
                                    </tr> 
                                    {$tr = true} 
                                 {/if} 
                            {/foreach}
                             <tr>
                                <td colspan="3"><div class="games_main_list_title"><br>{if $nr_of_games == 1}1 game found {else} {$nr_of_games} games found{/if} in {$query_time} sec<br><br></div></td>
                            </tr>
                        </table>
                    </div>           
                    <div id="games_list_2">
                       <table class="standard_table_list_comments">
                            {$tr = true} 
                            {foreach from=$game_search item=line name=game_search}
                                {if $tr} 
                                    <tr>
                                    {$tr = false}    
                                {/if}
                                    <td style="width:25%;">
                                        {if $line.screenshot_id != ''}
                                            <div class="games_main_list_title">
                                                <a href="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=410,null,null,null" data-lightbox="image-1" data-title="{$line.game_name}">
                                                    <br><img src="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=200,null,null,null" width="200" alt="Click to enlarge!" class="game_main_list_screenshot_img">
                                                </a>
                                            </div>
                                        {/if}
                                        <div class="games_main_list_title">
                                            <a href="games_detail.php?game_id={$line.game_id}" class="standard_table_left">
                                                <br>{$line.game_name}
                                            </a>
                                        </div>
                                        <div class="games_main_list_info">
                                            <a href="games_main_list.php?publisher={$line.publisher_id}&amp;action=search" class="standard_table_left">{$line.publisher_name}</a>{if (isset($line.year))}<a href="games_main_list.php?year={$line.year}&amp;action=search" class="standard_table_left">, {$line.year}</a>{/if}
                                        </div>  
                                        <div class="games_main_list_info" style="margin-bottom:10px;">
                                            {if $line.screenshot_id != ''}
                                                <i class="fa fa-camera" aria-hidden="true" title="More screenshots available"></i>
                                            {/if}
                                            {if isset($line.music)}
                                                <i class="fa fa-music" aria-hidden="true" title="Music available"></i>
                                            {/if}
                                            {if isset($line.boxscan)}
                                                <i class="fa fa-cube" aria-hidden="true" title="Boxscan available"></i>
                                            {/if}
                                            {if isset($line.download)}
                                                <i class="fa fa-file-o" aria-hidden="true" title="Download available"></i>
                                            {/if}
                                            {if isset($line.screenshot_id) or isset($line.music) or isset($line.boxscan) or isset($line.download)}
                                            {else}
                                                <br>
                                            {/if}
                                        </div>
                                   </td>
                                 {if $smarty.foreach.game_search.iteration is div by 2}       
                                    </tr> 
                                    {$tr = true} 
                                 {/if} 
                            {/foreach}
                             <tr>
                                <td colspan="2"><div class="games_main_list_title"><br>{if $nr_of_games == 1}1 game found {else} {$nr_of_games} games found{/if} in {$query_time} sec<br><br></div></td>
                            </tr>
                        </table>
                    </div>
                    <div id="games_list_1">
                        <table class="standard_table_list_comments">
                            {foreach from=$game_search item=line name=game_search}
                                <tr>
                                    <td style="width:25%;">
                                        {if $line.screenshot_id != ''}
                                            <div class="games_main_list_title">
                                                <a href="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=410,null,null,null" data-lightbox="image-1" data-title="{$line.game_name}">
                                                    <br><img src="../../includes/show_image.php?file={$line.screenshot_image}&amp;resize=200,null,null,null" width="200" alt="Click to enlarge!" class="game_main_list_screenshot_img">
                                                </a>
                                            </div>
                                        {/if}
                                        <div class="games_main_list_title">
                                            <a href="games_detail.php?game_id={$line.game_id}" class="standard_table_left">
                                                <br>{$line.game_name}
                                            </a>
                                        </div>
                                        <div class="games_main_list_info">
                                            <a href="games_main_list.php?publisher={$line.publisher_id}&amp;action=search" class="standard_table_left">{$line.publisher_name}</a>{if (isset($line.year))}<a href="games_main_list.php?year={$line.year}&amp;action=search" class="standard_table_left">, {$line.year}</a>{/if}
                                        </div>  
                                        <div class="games_main_list_info" style="margin-bottom:10px;">
                                            {if $line.screenshot_id != ''}
                                                <i class="fa fa-camera" aria-hidden="true" title="More screenshots available"></i>
                                            {/if}
                                            {if isset($line.music)}
                                                <i class="fa fa-music" aria-hidden="true" title="Music available"></i>
                                            {/if}
                                            {if isset($line.boxscan)}
                                                <i class="fa fa-cube" aria-hidden="true" title="Boxscan available"></i>
                                            {/if}
                                            {if isset($line.download)}
                                                <i class="fa fa-file-o" aria-hidden="true" title="Download available"></i>
                                            {/if}
                                            {if isset($line.screenshot_id) or isset($line.music) or isset($line.boxscan) or isset($line.download)}
                                            {else}
                                                <br>
                                            {/if}
                                        </div>
                                   </td> 
                                </tr> 
                            {/foreach}
                             <tr>
                                <td><div class="games_main_list_title"><br>{if $nr_of_games == 1}1 game found {else} {$nr_of_games} games found{/if} in {$query_time} sec<br><br></div></td>
                            </tr>
                        </table>
                    </div>
                </div>
            {/if}
            <br>
            <div class="standard_table_center"><a href="javascript:history.go(-1)" class="standard_tile_link">back</a></div>
        </div>
        <div class="content_box_cpanel" id="column_right_cpanel">
            <br>
            {block name=right_tile}
                {include file='1/main/tile_changes_per_month.html'}
            {/block}        
        </div>
    </div>
    
{/block}
